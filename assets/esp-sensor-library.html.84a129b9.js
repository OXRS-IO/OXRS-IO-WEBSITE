import{_ as r,r as s,o as d,c as l,a as i,b as a,d as t,e}from"./app.f95394c5.js";const o={},c=t(`<h1 id="esp-sensor-library" tabindex="-1"><a class="header-anchor" href="#esp-sensor-library" aria-hidden="true">#</a> ESP SENSOR library</h1><p class="maker">by <b>Austin&#39;s Creations</b></p><blockquote><p>SKU: OXRS-AC-SENSORS-ESP-LIB</p></blockquote><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>This library wraps up an I2C bus scanner + MQTT handling for QWIIC/Stemma I2C sensors</p><p>The library Supports</p><ul><li>BH1750 LUX sensor</li><li>SHT40 Temperature and Humidity Sensor</li><li>MCP9808 Temperature Sensor</li></ul><p>Using this library means that config upon startup can be dynamic based on device configuration. All incoming and outgoing MQTT is handled by the library, minimizing required code in main sketch. The library also handles the JSON payload for the OXRS API/MQTT adoption code, saving from having to copy/paste extra code in your main sketch. The adopt code is also dynamic - disabling elements that aren&#39;t connected.</p><hr><h3 id="dependencies" tabindex="-1"><a class="header-anchor" href="#dependencies" aria-hidden="true">#</a> Dependencies</h3><p>Library requires quite a few libraries</p><div class="language-c++ ext-c++ line-numbers-mode"><pre class="language-c++"><code>#include &lt;Arduino.h&gt;
#include &lt;ArduinoJson.h&gt;
#include &lt;Wire.h&gt;                     // For I2C
#include &lt;Adafruit_MCP9808.h&gt;         // For temp sensor
#include &lt;Adafruit_SHT4x.h&gt;           // For SHT40 Temp / humidity sensor
#include &lt;BH1750.h&gt;                   // For BH1750 lux sensor - non-adafruit library: https://github.com/claws/BH1750
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="setup" tabindex="-1"><a class="header-anchor" href="#setup" aria-hidden="true">#</a> Setup</h3><p>To use the library, ensure you have it downloaded/installed. The library is normally declared near the top of a sketch. After this is done the library instance needs to be called/set. Because the library uses I2C <code>Wire.begin()</code> should be called. You may need to include the SDA + SCL pin numbers in this declaration depending on hardware used.</p><div class="language-c++ ext-c++ line-numbers-mode"><pre class="language-c++"><code>#include &lt;OXRS_SENSORS.h&gt;           // Declare the library

OXRS_SENSORS sensors();             // Create library isntance

Wire.begin(SDA,SCL);                // Start I2C connection, but with different I2C pins

sensors.begin();                    // Start the Library - placed within SETUP()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There are also routines that need to be called within MQTT routines.</p><div class="language-c++ ext-c++ line-numbers-mode"><pre class="language-c++"><code>sensors.setConfigSchema(properties);  // Placed within main sketch ConfigSchema routine

sensors.setCommandSchema(properties); // Placed within main sketch CommandSchema routine

sensors.conf(json);                   // Placed within main sketch CONF callback routine

sensors.cmnd(json);                   // Placed within main sketch CMND callback routine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>See the libraries built in examples to better see how and where to place routines and callbacks.</p><h3 id="program-loop" tabindex="-1"><a class="header-anchor" href="#program-loop" aria-hidden="true">#</a> Program Loop</h3><p>The main loop requires you to request any telemetry data, if if returned, to publish it.</p><div class="language-c++ ext-c++ line-numbers-mode"><pre class="language-c++"><code>  StaticJsonDocument&lt;150&gt; telemetry;
  sensors.tele(telemetry.as&lt;JsonVariant&gt;());

  if (telemetry.size() &gt; 0)
  {
    oxrs.publishTelemetry(telemetry.as&lt;JsonVariant&gt;());
  }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="config" tabindex="-1"><a class="header-anchor" href="#config" aria-hidden="true">#</a> Config</h3><p>The library can automatically handle incoming MQTT config payloads to control sensors.</p><h3 id="command" tabindex="-1"><a class="header-anchor" href="#command" aria-hidden="true">#</a> Command</h3><p>The library can automatically handle incoming MQTT commands payloads to control sensors (none current supported).</p><h3 id="publishing" tabindex="-1"><a class="header-anchor" href="#publishing" aria-hidden="true">#</a> Publishing</h3><p>The library will generate telemetry data in JSON format, ready for publishing.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>These topics will be different if you set a topic prefix or suffix. E.g. a topic prefix of <code>home</code> and suffix of <code>oxrs</code> would result in a LWT topic of <code>home/stat/&lt;clientid&gt;/oxrs/lwt</code></p></div><table><thead><tr><th style="text-align:left;">Publish API</th><th style="text-align:left;">Topic</th><th style="text-align:left;">Retained</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>publishTelemetry</code></td><td style="text-align:left;"><code>tele/&lt;clientid&gt;</code></td><td style="text-align:left;">false</td><td style="text-align:left;">Publish a JSON <strong>telemetry</strong> message, e.g. when publishing regular sensor data</td></tr></tbody></table><h2 id="downloads" tabindex="-1"><a class="header-anchor" href="#downloads" aria-hidden="true">#</a> Downloads</h2>`,30),h=e("Download the latest version of the library on "),u={href:"https://github.com/austinscreations/OXRS-AC-I2CSensors-ESP-LIB",target:"_blank",rel:"noopener noreferrer"},p=e("Github"),b=e("."),m=t('<h2 id="supported-hardware" tabindex="-1"><a class="header-anchor" href="#supported-hardware" aria-hidden="true">#</a> Supported Hardware</h2><p>This library is compatible with ESP32 and ESP8266 microprocessors.</p><hr><h4 id="credits" tabindex="-1"><a class="header-anchor" href="#credits" aria-hidden="true">#</a> Credits</h4><ul><li>Austins Creations</li><li>Ben Jones</li></ul><hr><h4 id="license" tabindex="-1"><a class="header-anchor" href="#license" aria-hidden="true">#</a> License</h4>',7),v=e("Found "),g={href:"https://github.com/austinscreations/OXRS-AC-I2CSensors-ESP-LIB/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer"},f=e("here"),y=e(".");function S(x,_){const n=s("ExternalLinkIcon");return d(),l("div",null,[c,i("p",null,[h,i("a",u,[p,a(n)]),b]),m,i("p",null,[v,i("a",g,[f,a(n)]),y])])}var C=r(o,[["render",S],["__file","esp-sensor-library.html.vue"]]);export{C as default};
